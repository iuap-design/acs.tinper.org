<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>富文本编辑器sany版本 AcEditorSany</title>
    <link type="text/css" rel="stylesheet" href="assets/css/bootstrap.css"/>
    <link type="text/css" rel="stylesheet" href="assets/css/bootstrap-responsive.css"/>
    <link type="text/css" rel="stylesheet" href="assets/css/pilcrow.css"/>
    <link type="text/css" rel="stylesheet" href="assets/css/hljs-github.min.css"/>
    <link type="text/css" rel="stylesheet" href="assets/css/style.css"/>
  </head>
<body>

  <div class="container-fluid">
    <div class="row-fluid">
      <div class="span3"><ul class="nav nav-list">
    <li class="sidebar-header-1"><a href="#富文本编辑器sany版本-aceditorsany">富文本编辑器sany版本 AcEditorSany</a></li>
    <li class="sidebar-header-2"><a href="#如何使用">如何使用</a></li>
    <li class="sidebar-header-2"><a href="#代码演示">代码演示</a></li>
    <li class="sidebar-header-2"><a href="#api">API</a></li>
    <li class="sidebar-header-3"><a href="#aceditorsany-api">AcEditorSany API</a></li>
    <li class="sidebar-header-3"><a href="#aceditorshow-api">AcEditorShow API</a></li>
    <li class="sidebar-header-3"><a href="#aceditorpdf-api">AcEditorPDF API</a></li>
    <li class="sidebar-header-3"><a href="#aceditorword-api">AcEditorWord API</a></li>
    <li class="sidebar-header-3"><a href="#fixeddate-参数">fixedDate 参数</a></li>
    <li class="sidebar-header-3"><a href="#defaultdata-参数">defaultData 参数</a></li>
    <li class="sidebar-header-3"><a href="#tablepagelist-参数">tablePageList 参数</a></li>
    <li class="sidebar-header-2"><a href="#注意事项">注意事项</a></li>
    <li class="sidebar-header-2"><a href="#更新日志">更新日志</a></li>
</ul>
      </div>
      <div class="span9 main"><h1 id="富文本编辑器sany版本-aceditorsany">富文本编辑器sany版本 AcEditorSany</h1>
<p>React复杂文本编辑器组件，可插入日期、下拉框、单选框、多选框、单行文本输入框、多行文本输入框、固定字段等常用组件，同时提供文本编辑生成的页面支持动态交互(表单提交)、内容动态替换(设置默认值)和生成水印功能，生成的页面支持前端打印(表格分页带表头、表格横排打印、自定义打印样式)和导出word功能。</p>
<h2 id="如何使用">如何使用</h2>
<p>1.AcEditorSany使用</p>
<pre class="hljs"><code><span class="hljs-keyword">import</span> { AcEditorShow } <span class="hljs-keyword">from</span> <span class="hljs-string">'ac-editor-sany'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'ac-editor-sany/dist/index.css'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  saveFunc = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// doc 为文本编辑器里的html字符串</span>
    <span class="hljs-comment">// idList 为插入组件属性(field,direction,type,data,defaultValue) 数组</span>
    <span class="hljs-keyword">const</span> { doc, idList } = <span class="hljs-keyword">this</span>.child.getHtml2String();
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'文本编辑器内容为'</span>, doc, idList);
  };


  fixedDate = [
    {
      <span class="hljs-attr">field</span>: <span class="hljs-string">'buyerwwyy1'</span>, <span class="hljs-comment">// 固定字段唯一标识</span>
      type: <span class="hljs-string">'text'</span>, <span class="hljs-comment">// 字段类型 (text,date,checkbox,radio,select,textarea)</span>
      filedType: <span class="hljs-string">'文本'</span>, <span class="hljs-comment">//字段类型中文名</span>
      fieldName: <span class="hljs-string">'买方名称'</span>, <span class="hljs-comment">// 字段名称</span>
      data: <span class="hljs-string">'xxxx'</span>, <span class="hljs-comment">// 字段值(checkbox、select、radio值用 "|||" 链接)</span>
      defaultValue: <span class="hljs-string">'买方名称'</span>, <span class="hljs-comment">// 默认选中值(checkbox 用 "|||")</span>
    },
    {
      <span class="hljs-attr">field</span>: <span class="hljs-string">'contractswwwignyy3'</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'date'</span>,
      <span class="hljs-attr">fieldName</span>: <span class="hljs-string">'合同签订日期'</span>,
      <span class="hljs-attr">filedType</span>: <span class="hljs-string">'日期'</span>,
      <span class="hljs-attr">data</span>: <span class="hljs-string">'2019-02-20'</span>,
      <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'2019-02-20'</span>,
    },
    {
      <span class="hljs-attr">field</span>: <span class="hljs-string">'paytewwwrmyy6'</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'select'</span>,
      <span class="hljs-attr">filedType</span>: <span class="hljs-string">'下拉'</span>,
      <span class="hljs-attr">fieldName</span>: <span class="hljs-string">'付款条件'</span>,
      <span class="hljs-attr">data</span>: <span class="hljs-string">'现金支付|||微信支付|||支付宝支付'</span>,
      <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'微信支付'</span>,
    },
    {
      <span class="hljs-attr">field</span>: <span class="hljs-string">'isrebatwwweyy7'</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'radio'</span>,
      <span class="hljs-attr">filedType</span>: <span class="hljs-string">'单选'</span>,
      <span class="hljs-attr">fieldName</span>: <span class="hljs-string">'是否返利'</span>,
      <span class="hljs-attr">data</span>: <span class="hljs-string">'是|||否'</span>,
      <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'否'</span>,
    },
  ];

  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"demoPadding"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.saveFunc}</span>&gt;</span>保存<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">AcEditorSany</span>
          <span class="hljs-attr">editorId</span>=<span class="hljs-string">"acEditorSanyId"</span> // 组件<span class="hljs-attr">id</span>
          <span class="hljs-attr">onRef</span>=<span class="hljs-string">{ref</span> =&gt;</span> this.child = ref} // 设置ref属性
          height="300px"  // 文本框默认最小高
          fixedDate={this.fixedDate} // 固定字段
        /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    );
  }
}

export default Demo1;
</span></code></pre><p>2.AcEditorShow 使用</p>
<pre class="hljs"><code><span class="hljs-keyword">import</span> { AcEditorSany } <span class="hljs-keyword">from</span> <span class="hljs-string">'ac-editor-sany'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'ac-editor-sany/dist/index.css'</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{


  saveFunc = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// doc 为文本编辑器里的html字符串</span>
    <span class="hljs-comment">// idList 为插入组件属性(field,direction,type,data,defaultValue) 数组</span>
    <span class="hljs-keyword">const</span> { doc, idList } = <span class="hljs-keyword">this</span>.child.getHtml2String();
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'文本编辑器内容为'</span>, doc, idList);
  };

  render() {

    <span class="hljs-keyword">const</span> defaultData = [
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'buyerww1'</span>, <span class="hljs-comment">// 被替换对象的唯一标识</span>
        direction: <span class="hljs-string">'horizontal'</span>, <span class="hljs-comment">// 组件布局方向(horizontal,vertical)</span>
        data: <span class="hljs-string">'买方名称'</span>, <span class="hljs-comment">// 组件值(select、checkbox、radio 用 "|||" 链接)</span>
        type: <span class="hljs-string">'text'</span>, <span class="hljs-comment">// 组件类型</span>
        defaultValue: <span class="hljs-string">'买方名称eee'</span> <span class="hljs-comment">// 组件默认值( checkbox用 "|||" 链接)</span>
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'salername22'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'卖方名称'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'text'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'卖方名称'</span>
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'contractswwwign3'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'2019-02-20'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'date'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'2019-02-20'</span>
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'contractstrwww4'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'2019-02-20'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'date'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'2019-02-20'</span>
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'contractendxxx5'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'2019-02-20'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'date'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'2019-02-20'</span>
      }, {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'paytewwwrm6'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'现金支付|||微信支付|||支付宝支付'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'select'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'微信支付'</span>
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'isrebatwwwe7'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'是|||否'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'radio'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'是'</span>
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'dd74eab6-bccd-4b0c-843d-c33eecfe2580'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'1YYYYY|||2YYYYY|||3YYYYY'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'checkbox'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'1YYYYY|||3YYYYY'</span>,
      },
    ];
    <span class="hljs-keyword">const</span> isActive = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">const</span> htmlString = <span class="hljs-string">'&lt;span&gt;&lt;input type="text" value="买方名称" onkeyup="onKeyUpInput(event)" id="buyerww1" acType="text" /&gt;&lt;input type="text" value="买方名称" onkeyup="onKeyUpInput(event)" id="salername22" value="卖方名称" acType="text" /&gt;&lt;input type="text" id="contractswwwign3" value="2019-02-20" actype="date" style="width: 100px" readonly="true"&gt;&lt;input type="text" id="contractstrwww4" value="2019-02-20" actype="date" style="width: 100px" readonly="true"&gt;&lt;input type="text" id="contractendxxx5" value="2019-02-20" actype="date" style="width: 100px" readonly="true"&gt;&lt;select id="paytewwwrm6" class="select ac-select" onchange="onChangeSelect(event)"&gt;&lt;option name="paytewwwrm6" value="现金支付"&gt;现金支付&lt;/option&gt;,&lt;option name="paytewwwrm6" value="微信支付" selected=""&gt;微信支付&lt;/option&gt;,&lt;option name="paytewwwrm6" value="支付宝支付"&gt;支付宝支付&lt;/option&gt;&lt;/select&gt;&lt;span id="dd74eab6-bccd-4b0c-843d-c33eecfe2580" class="ac-checkbox-group"&gt;&lt;span&gt;&lt;input name="dd74eab6-bccd-4b0c-843d-c33eecfe2580" onclick="onClickCheckbox(event)" type="checkbox" actype="checkbox" checked="true" value="1YYYYY"&gt;&lt;span style="margin: 0 10px"&gt;1YYYYY&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;input name="dd74eab6-bccd-4b0c-843d-c33eecfe2580" onclick="onClickCheckbox(event)" type="checkbox" actype="checkbox" value="2YYYYY"&gt;&lt;span style="margin: 0 10px"&gt;2YYYYY&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;input name="dd74eab6-bccd-4b0c-843d-c33eecfe2580" onclick="onClickCheckbox(event)" type="checkbox" actype="checkbox" value="3YYYYY"&gt;&lt;span style="margin: 0 10px"&gt;3YYYYY&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span id="isrebatwwwe7" class="ac-radio-group"&gt;&lt;span&gt;&lt;input name="isrebatwwwe7" onclick="onClickRadio(event)" type="radio" style="vertical-align: middle;" value="是" actype="radio" checked="true"&gt;&lt;span style="margin: 0 10px"&gt;是&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;input name="isrebatwwwe7" onclick="onClickRadio(event)" type="radio" style="vertical-align: middle;" value="否" actype="radio"&gt;&lt;span style="margin: 0 10px"&gt;否&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;'</span>;
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"demoPadding"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.saveFunc}</span>&gt;</span>保存<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">AcEditorShow</span>
          <span class="hljs-attr">htmlString</span>=<span class="hljs-string">{htmlString}</span> // 用 <span class="hljs-attr">AcEditorShow</span> 生成的<span class="hljs-attr">html</span>字符串
          <span class="hljs-attr">editorId</span>=<span class="hljs-string">"showId"</span> // 组件 <span class="hljs-attr">id</span>
          <span class="hljs-attr">isActive</span>=<span class="hljs-string">{isActive}</span> // 组件是否可以操作 <span class="hljs-attr">disable</span>
          <span class="hljs-attr">defaultData</span>=<span class="hljs-string">{defaultData}</span> // 替换组件默认值
          <span class="hljs-attr">waterMarkerText</span>=<span class="hljs-string">"用友网络"</span> // 添加水印
          <span class="hljs-attr">onRef</span>=<span class="hljs-string">{ref</span> =&gt;</span> this.child = ref}  // 设置ref属性
        /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    );
  }
}

export default Demo2;
</span></code></pre><p>3.AcEditorPDF 使用</p>
<pre class="hljs"><code><span class="hljs-keyword">import</span> { AcEditorShow,AcEditorPDF } <span class="hljs-keyword">from</span> <span class="hljs-string">'ac-editor-sany'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'ac-editor-sany/dist/index.css'</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo3</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{

  <span class="hljs-comment">// 生成随机字符串</span>
  randomText = <span class="hljs-function">(<span class="hljs-params">len</span>) =&gt;</span> {
    <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> str = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">const</span> base = <span class="hljs-number">20000</span>;
    <span class="hljs-keyword">const</span> range = <span class="hljs-number">1000</span>;
    <span class="hljs-keyword">while</span> (i &lt; len) {
      i++;
      <span class="hljs-keyword">const</span> lower = <span class="hljs-built_in">parseInt</span>(<span class="hljs-built_in">Math</span>.random() * range);
      str += <span class="hljs-built_in">String</span>.fromCharCode(base + lower);
    }
    <span class="hljs-keyword">return</span> str;
  };


  <span class="hljs-comment">// 生成 table 函数</span>
  initTable = <span class="hljs-function">(<span class="hljs-params">rowNum, colNum, id, tableTitle,</span>) =&gt;</span> {
    <span class="hljs-comment">// 表头</span>
    <span class="hljs-keyword">let</span> thList = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> num = <span class="hljs-number">0</span>; num &lt; colNum; num += <span class="hljs-number">1</span>) {
      thList += <span class="hljs-string">` &lt;th&gt;<span class="hljs-subst">${tableTitle + num}</span>&lt;/th&gt;`</span>;
    }
    <span class="hljs-keyword">const</span> trTh = <span class="hljs-string">`&lt;tr&gt;<span class="hljs-subst">${thList}</span>&lt;/tr&gt;`</span>;
    <span class="hljs-comment">// 多少行</span>
    <span class="hljs-keyword">let</span> trTdList = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> trNum = <span class="hljs-number">0</span>; trNum &lt; rowNum; trNum += <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">let</span> tdList = <span class="hljs-string">''</span>;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> num = <span class="hljs-number">0</span>; num &lt; colNum; num += <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">const</span> title = <span class="hljs-keyword">this</span>.randomText(<span class="hljs-built_in">parseInt</span>(<span class="hljs-number">20</span> * <span class="hljs-built_in">Math</span>.random()));
        <span class="hljs-keyword">if</span> (num === <span class="hljs-number">0</span>) {
          tdList += <span class="hljs-string">`&lt;td&gt; <span class="hljs-subst">${trNum}</span>&lt;/td&gt;`</span>;
        } <span class="hljs-keyword">else</span> {
          tdList += <span class="hljs-string">`&lt;td&gt; <span class="hljs-subst">${title}</span>&lt;/td&gt;`</span>;
        }

      }
      trTdList += <span class="hljs-string">`&lt;tr&gt;<span class="hljs-subst">${tdList}</span>&lt;/tr&gt;`</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">`&lt;table id="<span class="hljs-subst">${id}</span>" border="1" width="100%" cellPadding="0" cellSpacing="0" class="rich-table"&gt;<span class="hljs-subst">${trTh}</span><span class="hljs-subst">${trTdList}</span>&lt;/table&gt;`</span>;
  };


  render() {
    <span class="hljs-keyword">const</span> defaultData = [
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'d9e40ab6-a2e1-48ea-8e5e-a5b451bdd132'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'xxx'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'text'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'xxx'</span>,
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'1d560209-1347-4133-9b7f-b01b6ff491f7'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">''</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'text'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">''</span>,
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'2e5fcbf7-c7ff-4a3d-852f-b159549cfaf8'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'2019-05-07'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'date'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'2019-05-07'</span>,
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'26222e13-2782-4495-893a-b1eb13097450'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'现金支付|||微信支付'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'select'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'微信支付'</span>,
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'065c0a49-fb1d-4171-9c2d-057836b2220c'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'1XXXXX|||2XXXXX|||3XXXXX'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'radio'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'1XXXXX'</span>,
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'99c19ed0-2a89-4eca-8910-d79effd0fea3'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'1YYYYY|||2YYYYY'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'checkbox'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'1YYYYY'</span>,
      },
      {
        <span class="hljs-attr">data</span>: <span class="hljs-string">'发速度发顺丰的↵fasdfasdf'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'发速度发顺丰的↵fasdfasdf'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">field</span>: <span class="hljs-string">'3cb3d3f0-fb05-4ad8-9bbc-9e85a32e6d4a'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'textarea'</span>,
      },
    ];


    <span class="hljs-keyword">const</span> isActive = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">const</span> htmlString = <span class="hljs-string">`&lt;div class="always"&gt;&lt;h1 style="text-align: center;" &gt;xxx公司供应商合同&lt;/h1&gt;&lt;div&gt;\n'
      &lt;div&gt;合同内容&lt;/div&gt;
      <span class="hljs-subst">${<span class="hljs-keyword">this</span>.initTable(<span class="hljs-number">100</span>, <span class="hljs-number">4</span>, <span class="hljs-string">'table-page'</span>, <span class="hljs-string">'分页'</span>)}</span>
      <span class="hljs-subst">${<span class="hljs-keyword">this</span>.initTable(<span class="hljs-number">100</span>, <span class="hljs-number">5</span>, <span class="hljs-string">'table-page-two'</span>, <span class="hljs-string">'分页2'</span>)}</span>
       &lt;h3 id="tableTitleId" class='print-display'&gt;附件一&lt;/h3&gt;
      <span class="hljs-subst">${<span class="hljs-keyword">this</span>.initTable(<span class="hljs-number">500</span>, <span class="hljs-number">8</span>, <span class="hljs-string">'rotate-table-sany'</span>, <span class="hljs-string">'旋转'</span>)}</span>
      &lt;h3 id="tableNoticeId" class='print-display'&gt;注：以上单价均为不含税单价，卖方应向买方提供税率约定的增值税专用发票&lt;/h3&gt;

`</span>;

    <span class="hljs-keyword">return</span> (
      &lt;div className="demoPadding"&gt;
        &lt;div style={{
          marginLeft: '20px',
          marginBottom: '10px',
        }}
        &gt;
          {/* 只能一个表格旋转 而且表格的id 为 rotate-table-sany */}
          &lt;AcEditorPDF
            title={&lt;button&gt;打印PDF&lt;/button&gt;}
            tablePageList={[
              {
                id: 'table-page', // 分页表格id
                rowNum: 35 // 分页条数
              },
              {
                id: 'table-page-two',
                rowNum: 35
              },
            ]}
            formInfo={() =&gt; { // 回调获取打印数据
              // return {
              //   doc: htmlString, // dom 节点
              //   idList: defaultData, // dom 要被替换的内容
              //
              // };
              return this.child.getHtml2String();
            }}

            tableRow={21} // 最后一个旋转table 的A4 最多多少行
            tableTitleId="tableTitleId" // 表标题 例如："附件一"
            tableNoticeId="tableNoticeId" // 表格备注 例如:"注:xxxx"
          /&gt;
        &lt;/div&gt;

        &lt;AcEditorShow
          htmlString={htmlString} // 用 AcEditorShow 生成的html字符串
          editorId="demo3EditorId" // 组件 id
          isActive={isActive} // 组件是否可以操作
          defaultData={defaultData} // 替换组件默认值
          waterMarkerText="用友网络" // 添加水印
          onRef={ref =&gt; this.child = ref}
        /&gt;
      &lt;/div&gt;
    );
  }
}

export default Demo3;</code></pre><p>4.AcEditorWord 使用</p>
<pre class="hljs"><code><span class="hljs-keyword">import</span> { AcEditorShow,AcEditorWord } <span class="hljs-keyword">from</span> <span class="hljs-string">'ac-editor-sany'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'ac-editor-sany/dist/index.css'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo4</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{

  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);
    <span class="hljs-keyword">this</span>.state = {
      <span class="hljs-attr">status</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 导出状态</span>
    };
  }

  render() {
    <span class="hljs-comment">// 自定义导出样式</span>
    <span class="hljs-keyword">const</span> styles = <span class="hljs-string">'.testClass{background-color: #ff00ff;}'</span>;
    <span class="hljs-keyword">const</span> defaultData = [
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'ff55b00a-f4aa-43b7-b7eb-f545ccac0fd9'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'1YYYYY|||2YYYYY|||3YYYYY|||4YYYYY'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'checkbox'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'1YYYYY'</span>,
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'629180d0-ff59-44a5-8f86-9c7360961e12'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'1XXXXX|||2XXXXX|||3XXXXX'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'radio'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'1XXXXX'</span>,
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'9013b8fc-e610-419d-bba0-196ec76b73cd'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'法师打发斯蒂芬'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'text'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'法师打发斯蒂芬'</span>,
      },
      {
        <span class="hljs-attr">field</span>: <span class="hljs-string">'a0a8252d-94b3-4436-9433-d37e589508eb'</span>,
        <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
        <span class="hljs-attr">data</span>: <span class="hljs-string">'支付宝|||银行卡|||微信'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'select'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">'支付宝'</span>,
      },
    ];

    <span class="hljs-keyword">const</span> isActive = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">const</span> htmlString = <span class="hljs-string">'&lt;span id="ff55b00a-f4aa-43b7-b7eb-f545ccac0fd9" class="ac-checkbox-group"&gt;&lt;span&gt;&lt;input name="ff55b00a-f4aa-43b7-b7eb-f545ccac0fd9" onclick="onClickCheckbox(event)" type="checkbox" actype="checkbox" checked="true" value="1YYYYY"&gt;&lt;span style="margin: 0 10px"&gt;1YYYYY&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;input name="ff55b00a-f4aa-43b7-b7eb-f545ccac0fd9" onclick="onClickCheckbox(event)" type="checkbox" actype="checkbox" value="2YYYYY"&gt;&lt;span style="margin: 0 10px"&gt;2YYYYY&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;input name="ff55b00a-f4aa-43b7-b7eb-f545ccac0fd9" onclick="onClickCheckbox(event)" type="checkbox" actype="checkbox" value="3YYYYY"&gt;&lt;span style="margin: 0 10px"&gt;3YYYYY&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;input name="ff55b00a-f4aa-43b7-b7eb-f545ccac0fd9" onclick="onClickCheckbox(event)" type="checkbox" actype="checkbox" value="4YYYYY"&gt;&lt;span style="margin: 0 10px"&gt;4YYYYY&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(66, 66, 66);"&gt;互&lt;span id="629180d0-ff59-44a5-8f86-9c7360961e12" class="ac-radio-group"&gt;&lt;span&gt;&lt;input name="629180d0-ff59-44a5-8f86-9c7360961e12" onclick="onClickRadio(event)" type="radio" checked="true" style="vertical-align: middle;" value="1XXXXX" actype="radio"&gt;&lt;span style="margin: 0 10px"&gt;1XXXXX&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;input name="629180d0-ff59-44a5-8f86-9c7360961e12" onclick="onClickRadio(event)" type="radio" style="vertical-align: middle;" value="2XXXXX" actype="radio"&gt;&lt;span style="margin: 0 10px"&gt;2XXXXX&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;input name="629180d0-ff59-44a5-8f86-9c7360961e12" onclick="onClickRadio(event)" type="radio" style="vertical-align: middle;" value="3XXXXX" actype="radio"&gt;&lt;span style="margin: 0 10px"&gt;3XXXXX&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: rgb(66, 66, 66);"&gt;交&lt;input id="9013b8fc-e610-419d-bba0-196ec76b73cd" type="text" value="法师打发斯蒂芬" onkeyup="onKeyUpInput(event)" actype="text" style="width: 158px;"&gt;&lt;select id="a0a8252d-94b3-4436-9433-d37e589508eb" class="select ac-select" onchange="onChangeSelect(event)"&gt;&lt;option name="a0a8252d-94b3-4436-9433-d37e589508eb" value="支付宝" selected=""&gt;支付宝&lt;/option&gt;,&lt;option name="a0a8252d-94b3-4436-9433-d37e589508eb" value="银行卡"&gt;银行卡&lt;/option&gt;,&lt;option name="a0a8252d-94b3-4436-9433-d37e589508eb" value="微信"&gt;微信&lt;/option&gt;&lt;/select&gt;&lt;/span&gt;'</span>;
    <span class="hljs-keyword">const</span> _this = <span class="hljs-keyword">this</span>;

    <span class="hljs-keyword">return</span> (
      &lt;div className="wordTest"&gt;
        &lt;AcEditorWord
          wordId="wordTestId" // 与要导出的 dom id 保持一致
          fileName="合同"  // 导出 word 名称
          wordStyles={styles}  // 替换样式
          title={&lt;button&gt;导出word&lt;/button&gt;}

          getDefaultInfo={() =&gt; { // 获取默认值回调函数
            _this.setState({ status: true }); // 正在导出
            // return defaultData || []; // 替换数据
            const { idList = [] } = _this.child.getHtml2String();
            return idList;
          }}

          success={() =&gt; { // 导出成功回调
            _this.setState({ status: true });
          }}

        /&gt;

        &lt;AcEditorShow
          htmlString={htmlString} // 用 AcEditorSany 生成的 html字符串
          editorId="wordTestId" // 组件 id
          isActive={isActive} // 组件是否可以操作
          defaultData={defaultData} // 替换组件默认值
          waterMarkerText="用友网络" // 添加水印
          // 设置ref属性
          onRef={(ref) =&gt; {
            this.child = ref;
          }}
        /&gt;
      &lt;/div&gt;
    );
  }
}

export default Demo4;

</code></pre><h2 id="代码演示">代码演示</h2>
<h2 id="api">API</h2>
<h3 id="aceditorsany-api">AcEditorSany API</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>editorId</td>
<td>string</td>
<td>必填项</td>
<td>文本编辑器唯一id</td>
</tr>
<tr>
<td>onRef</td>
<td>function</td>
<td>非必须</td>
<td>设置ref属性</td>
</tr>
<tr>
<td>htmlString</td>
<td>string</td>
<td>&quot;&quot;</td>
<td>文本编辑器默认字符串</td>
</tr>
<tr>
<td>height</td>
<td>string</td>
<td>&quot;0px&quot;</td>
<td>文本编辑器默认最小高</td>
</tr>
<tr>
<td>fixedDate</td>
<td>array</td>
<td>[]</td>
<td>支持插入固定字段，参照demo1</td>
</tr>
<tr>
<td>defaultData</td>
<td>array</td>
<td>[]</td>
<td>默认值替换，替换htmlString 中组件</td>
</tr>
</tbody>
</table>
<h3 id="aceditorshow-api">AcEditorShow API</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>editorId</td>
<td>string</td>
<td>必填项</td>
<td>展示文本内容组件唯一id</td>
</tr>
<tr>
<td>onRef</td>
<td>function</td>
<td>非必须</td>
<td>设置ref属性</td>
</tr>
<tr>
<td>htmlString</td>
<td>string</td>
<td>&quot;&quot;</td>
<td>展示文本内容</td>
</tr>
<tr>
<td>isActive</td>
<td>boolean</td>
<td>true</td>
<td>文本内容可交互</td>
</tr>
<tr>
<td>defaultData</td>
<td>array</td>
<td>[]</td>
<td>文本内容被替换信息</td>
</tr>
<tr>
<td>waterMarkerText</td>
<td>string</td>
<td>“”</td>
<td>生成水印</td>
</tr>
</tbody>
</table>
<h3 id="aceditorpdf-api">AcEditorPDF API</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>formInfo</td>
<td>function</td>
<td>必填项</td>
<td>回调函数，返回值{doc,idList}(要打印的dom，替换值数组)</td>
</tr>
<tr>
<td>title</td>
<td>string/element</td>
<td>&quot;打印&quot;</td>
<td>打印按钮</td>
</tr>
<tr>
<td>tablePageList</td>
<td>array</td>
<td>[]</td>
<td>指定table 分页打印(id:表格id，rowNum：A4纸上打印多少条记录)</td>
</tr>
<tr>
<td>tableRow</td>
<td>number</td>
<td>非必须</td>
<td>最后一个旋转table 的A4 最多多少行</td>
</tr>
<tr>
<td>tableTitleId</td>
<td>string</td>
<td>非必须</td>
<td>表标题 例如：&quot;附件一&quot;</td>
</tr>
<tr>
<td>tableNoticeId</td>
<td>string</td>
<td>非必须</td>
<td>表格备注 例如:&quot;注:xxxx&quot;</td>
</tr>
</tbody>
</table>
<h3 id="aceditorword-api">AcEditorWord API</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>wordId</td>
<td>string</td>
<td>必填项</td>
<td>与要导出的 dom id 保持一致</td>
</tr>
<tr>
<td>fileName</td>
<td>string</td>
<td>非必须</td>
<td>导出word名</td>
</tr>
<tr>
<td>wordStyles</td>
<td>string</td>
<td>非必须</td>
<td>导出word 样式</td>
</tr>
<tr>
<td>title</td>
<td>string/element</td>
<td>&quot;导出wrod&quot;</td>
<td>导出word按钮</td>
</tr>
<tr>
<td>getDefaultInfo</td>
<td>function</td>
<td>非必须</td>
<td>获取导出默认值</td>
</tr>
<tr>
<td>success</td>
<td>function</td>
<td>非必须</td>
<td>导出成功回调</td>
</tr>
</tbody>
</table>
<h3 id="fixeddate-参数">fixedDate 参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>必填项</td>
<td>固定字段唯一标识</td>
</tr>
<tr>
<td>direction</td>
<td>string</td>
<td>&quot;horizontal&quot;</td>
<td>固定字段布局方向(horizontal,vertical)</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>&quot;&quot;</td>
<td>固定字段值(select、checkbox、radio 用 &quot;</td>
<td></td>
<td></td>
<td>&quot; 链接)</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>&quot;text&quot;</td>
<td>固定字段类型(text,date,checkbox,radio,select,textarea)</td>
</tr>
<tr>
<td>filedType</td>
<td>string</td>
<td>&quot;文本&quot;</td>
<td>固定字段中文类型</td>
</tr>
<tr>
<td>defaultValue</td>
<td>string</td>
<td>&quot;&quot;</td>
<td>固定字段默认值( checkbox用 &quot;</td>
<td></td>
<td></td>
<td>&quot; 链接)</td>
</tr>
</tbody>
</table>
<h3 id="defaultdata-参数">defaultData 参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>必填项</td>
<td>分页表格id</td>
</tr>
<tr>
<td>direction</td>
<td>string</td>
<td>&quot;horizontal&quot;</td>
<td>组件布局方向(horizontal,vertical)</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>&quot;&quot;</td>
<td>组件值(select、checkbox、radio 用 &quot;</td>
<td></td>
<td></td>
<td>&quot; 链接)</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>&quot;text&quot;</td>
<td>组件类型(text,date,checkbox,radio,select,textarea)</td>
</tr>
<tr>
<td>defaultValue</td>
<td>string</td>
<td>&quot;&quot;</td>
<td>组件默认值( checkbox用 &quot;</td>
<td></td>
<td></td>
<td>&quot; 链接)</td>
</tr>
</tbody>
</table>
<h3 id="tablepagelist-参数">tablePageList 参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>必填项</td>
<td>分页表格id</td>
</tr>
<tr>
<td>rowNum</td>
<td>number</td>
<td>20</td>
<td>分页条数</td>
</tr>
</tbody>
</table>
<h2 id="注意事项">注意事项</h2>
<p>暂无</p>
<h2 id="更新日志">更新日志</h2>
      </div>
    </div>
  </div>

  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script type="text/javascript" src="assets/js/bootstrap.min.js"></script>
</body>
</html>
